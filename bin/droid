#!/usr/bin/env bash
set -euo pipefail

REAL_HOME="${HOME:-}"
REPO_ROOT="$(cd "$(dirname "${BASH_SOURCE[0]}")/.." && pwd)"
DROID_BIN="${FACTORY_DROID_BIN:-${REAL_HOME}/.local/bin/droid}"

if [[ ! -x "$DROID_BIN" ]]; then
  echo "droid binary not found at ${DROID_BIN}" >&2
  exit 127
fi

exec env HOME="$REPO_ROOT" "$DROID_BIN" "$@"
